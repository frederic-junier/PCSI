<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Chenevois-Jouhet-Junier" />
  <title>Corrigé du TP 12 Schémas numériques de résolution d’équations différentielles</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Corrigé du TP 12 Schémas numériques de résolution d’équations différentielles</h1>
  <p class="author">
Chenevois-Jouhet-Junier
  </p>
</div>
<div class="slide section level1">

<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="imports-de-bibliothèques-et-réglage-du-répertoire-de-travail" class="slide section level1">
<h1>Imports de bibliothèques et réglage du répertoire de travail</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
<ul>
<li>On va utiliser les bibliothéques/modules suivant(e)s :</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#imports pour tout le TP</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="im">import</span> os.path</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb4-7"><a href="#cb4-7"></a></span></code></pre></div>
<ul>
<li>Toutes les figures seront rangées dans un répertoire <code>jolis-dessins</code> situé dans le répertoire de travail <code>TP12</code> contenant le script. Avec <code>Pyzo</code>, il faut régler le répertoire de travail (point de départ du chemin relatif des ressources externes) en exécutant le script avec l’option <code>Run as script</code> ou la séquence de touches <code>CTRL + SHIFT + E</code>.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a></span>
<span id="cb5-2"><a href="#cb5-2"></a>REPERTOIRE <span class="op">=</span> <span class="st">&#39;jolis-dessins&#39;</span> <span class="co">#nom du répertoire de stockage des jolis dessins</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span></code></pre></div>
<ul>
<li>On peut vérifier la valeur du répertoire de travail avec la fonction <code>pwd</code> si l’interpréteur est Ipython.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">Running script: &quot;/home/fjunier/InfoPCSI/843/TP843/12-euler-rk4/2015-2016/corrige-tp12-euler-rk4-201-2015.py&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">In [1]: pwd</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">Out[1]: &#39;/home/fjunier/InfoPCSI/843/TP843/12-euler-rk4/2015-2016&#39;</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8"></a></span></code></pre></div>
</div>
<div id="rappel-sur-le-schéma-numérique-deuler-ordre-1" class="slide section level1">
<h1>Rappel sur le schéma numérique d’Euler (ordre 1)</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">def</span> euler(F, a, y0, b, n):</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="co">&quot;&quot;&quot;Retourne le tableau des approximations</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">    de y&#39;=F(t,y) avec y(a)=y0 par la methode d&#39;Euler avec un pas  de 1/n</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>    les_yk <span class="op">=</span> [y0]         <span class="co"># la liste des valeurs calculées</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    t <span class="op">=</span> a                <span class="co"># le temps du dernier calcul</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    h <span class="op">=</span> <span class="bu">float</span>(b<span class="op">-</span>a) <span class="op">/</span> n  <span class="co"># le pas</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>    dernier <span class="op">=</span> y0          <span class="co"># la dernière valeur calculée</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb7-11"><a href="#cb7-11"></a>        suivant <span class="op">=</span> dernier <span class="op">+</span> h<span class="op">*</span>F(dernier, t) <span class="co"># le nouveau terme</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>        les_yk.append(suivant)  <span class="co"># on le place à la fin des valeurs calculées</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>        t <span class="op">=</span> t<span class="op">+</span>h                 <span class="co"># le nouveau temps</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>        dernier <span class="op">=</span> suivant       <span class="co"># et on met à jour le dernier terme calculé</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>    <span class="cf">return</span> les_yk  <span class="co"># c&#39;est fini</span></span>
<span id="cb7-16"><a href="#cb7-16"></a></span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">In [6]: euler(lambda y, t : y, 0, 1, 1, 10)</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">Out[6]: </span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">[1,1.1,1.2100000000000002,1.3310000000000002,1.4641000000000002,1.61051,</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co"> 1.7715610000000002,1.9487171,2.1435888100000002,2.357947691,2.5937424601]</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div id="exercice-1-schéma-numérique-de-heun-ordre-2" class="slide section level1">
<h1>Exercice 1 Schéma numérique de Heun (ordre 2)</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">def</span> heun(F, a, y0, b, n):</span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="co">&quot;&quot;&quot;Retourne le tableau des approximations</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">    de y&#39;=F(t,y) avec y(a)=y0 par la methode de Heun avec un pas  de 1/n</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    les_yk <span class="op">=</span> [y0]         <span class="co">#la liste des valeurs calculées</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>    t <span class="op">=</span> a                <span class="co">#le temps du dernier calcul</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>    h <span class="op">=</span> <span class="bu">float</span>(b<span class="op">-</span>a) <span class="op">/</span> n  <span class="co">#le pas</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    dernier <span class="op">=</span> y0          <span class="co"># la dernière valeur calculée</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb8-11"><a href="#cb8-11"></a>        eul <span class="op">=</span> dernier <span class="op">+</span> h<span class="op">*</span>F(dernier, t) <span class="co"># ce que propose Euler</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>        suivant <span class="op">=</span> dernier <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span><span class="op">*</span>(F(dernier, t) <span class="op">+</span> F(eul, t<span class="op">+</span>h)) <span class="co">#nouveau terme</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>        les_yk.append(suivant)  <span class="co">#on le place à la fin des valeurs calculées</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>        t <span class="op">=</span> t<span class="op">+</span>h                 <span class="co">#nouveau temps</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>        dernier <span class="op">=</span> suivant       <span class="co">#on met à jour le dernier terme calculé</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    <span class="cf">return</span> les_yk</span>
<span id="cb8-17"><a href="#cb8-17"></a></span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="kw">def</span> f1(z, t):</span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="cf">return</span> z</span>
<span id="cb8-21"><a href="#cb8-21"></a></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">In [8]: heun(f1, 0, 1, 1, 2)</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">Out[8]: [1, 1.625, 2.640625]</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
<p>#Exercice 2 Schéma numérique de Runge-Kutta (ordre 4)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">def</span> RK4(F, a, y0, b, n):</span>
<span id="cb9-3"><a href="#cb9-3"></a>    <span class="co">&quot;&quot;&quot;Retourne le tableau des approximations</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">    de y&#39;=F(t,y) avec y(a)=y0 par la methode de RK4 avec un pas  de 1/n</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>    les_yk <span class="op">=</span> [y0]         <span class="co"># la liste des valeurs calculées</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>    t <span class="op">=</span> a                <span class="co"># le temps du dernier calcul</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>    h <span class="op">=</span> <span class="bu">float</span>(b<span class="op">-</span>a) <span class="op">/</span> n  <span class="co"># le pas</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>    dernier <span class="op">=</span> y0          <span class="co"># la dernière valeur calculée</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n): </span>
<span id="cb9-11"><a href="#cb9-11"></a>        alpha <span class="op">=</span> dernier <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span><span class="op">*</span>F(dernier, t)</span>
<span id="cb9-12"><a href="#cb9-12"></a>        beta <span class="op">=</span> dernier <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span><span class="op">*</span>F(alpha, t<span class="op">+</span>h<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13"></a>        gamma <span class="op">=</span> dernier <span class="op">+</span> h<span class="op">*</span>F(beta, t<span class="op">+</span>h<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb9-14"><a href="#cb9-14"></a>        suivant <span class="op">=</span> dernier <span class="op">+</span> h<span class="op">/</span><span class="dv">6</span><span class="op">*</span>(F(dernier, t) <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>F(alpha, t<span class="op">+</span>h<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>                        <span class="dv">2</span><span class="op">*</span>F(beta, t<span class="op">+</span>h<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> F(gamma,t<span class="op">+</span>h)) <span class="co"># le nouveau terme</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>        les_yk.append(suivant)  <span class="co"># on le place à la fin des valeurs calculées</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>        t <span class="op">=</span> t<span class="op">+</span>h                 <span class="co"># le nouveau temps</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>        dernier <span class="op">=</span> suivant       <span class="co"># et on met à jour le dernier terme calculé</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="cf">return</span> les_yk</span>
<span id="cb9-20"><a href="#cb9-20"></a></span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">In [10]: RK4(f1, 0, 1, 1, 2)</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">Out[10]: [1, 1.6484375, 2.71734619140625]</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div id="exercice-3-comparaison-des-quatre-schémas-numériques-pour-la-résolution-approchée-de-y-y-avec-y01" class="slide section level1">
<h1>Exercice 3 Comparaison des quatre schémas numériques pour la résolution approchée de <span class="math inline">\(y &#39;=y\)</span> avec <span class="math inline">\(y(0)=1\)</span></h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">def</span> exo3():</span>
<span id="cb10-3"><a href="#cb10-3"></a>    <span class="co">&quot;&quot;&quot;Comparaison des méthodes Euler, Heun, RK4, odeint (pas variable)</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">    sur le problème de Cauchy y&#39;=y avec y(0)=1 pour n=4, n=10, n=100, n=1000&quot;&quot;&quot;</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>    e <span class="op">=</span> np.exp(<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="bu">print</span>(<span class="st">&quot;exp(1)=</span><span class="sc">%.15f</span><span class="st">&quot;</span><span class="op">%</span>e)</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="co">#500 temps pour représenter la fonction exponentielle sur les graphiques</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>    tcontinu <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">500</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a>    <span class="co">#y exact (ou presque)</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>    yexpo <span class="op">=</span> np.exp(tcontinu)</span>
<span id="cb10-11"><a href="#cb10-11"></a>    <span class="co">#comparaison numérique pour 10, 100, 1000 temps</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>    <span class="cf">for</span> n <span class="kw">in</span> [<span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>]:</span>
<span id="cb10-13"><a href="#cb10-13"></a>        t <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>)       </span>
<span id="cb10-14"><a href="#cb10-14"></a>        yodeint <span class="op">=</span> odeint(<span class="kw">lambda</span> z, t : z, <span class="dv">1</span>, t)</span>
<span id="cb10-15"><a href="#cb10-15"></a>        yeuler <span class="op">=</span> euler(f1, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, n)</span>
<span id="cb10-16"><a href="#cb10-16"></a>        yheun <span class="op">=</span> heun(f1, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, n)</span>
<span id="cb10-17"><a href="#cb10-17"></a>        yrk4 <span class="op">=</span> RK4(f1, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, n)</span>
<span id="cb10-18"><a href="#cb10-18"></a>        eul, heu, rk4, od <span class="op">=</span> [y[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> y <span class="kw">in</span> [yeuler, yheun, yrk4, yodeint]]</span>
<span id="cb10-19"><a href="#cb10-19"></a>        <span class="bu">print</span>(<span class="st">&quot;Pour n=</span><span class="sc">%i</span><span class="st"> :</span><span class="ch">\n\t\t</span><span class="sc">%.15f</span><span class="ch">\t</span><span class="sc">%.15f</span><span class="ch">\t</span><span class="sc">%.15f</span><span class="ch">\t</span><span class="sc">%.15f</span><span class="st">&quot;</span><span class="op">%</span>(n,eul,heu,rk4,od))</span>
<span id="cb10-20"><a href="#cb10-20"></a>        <span class="bu">print</span>(<span class="st">&quot;Erreurs absolues : </span><span class="ch">\n\t\t</span><span class="sc">%.15f</span><span class="ch">\t</span><span class="sc">%.15f</span><span class="ch">\t</span><span class="sc">%.15f</span><span class="ch">\t</span><span class="sc">%.15f</span><span class="ch">\n</span><span class="st">&quot;</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>              <span class="op">%</span>(<span class="bu">abs</span>(eul<span class="op">-</span>e), <span class="bu">abs</span>(heu<span class="op">-</span>e), <span class="bu">abs</span>(rk4<span class="op">-</span>e),<span class="bu">abs</span>(od<span class="op">-</span>e)))</span>
<span id="cb10-22"><a href="#cb10-22"></a>        <span class="co">#graphique          </span></span>
<span id="cb10-23"><a href="#cb10-23"></a>        plt.plot(t, yeuler,color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;dashed&#39;</span>, label<span class="op">=</span><span class="st">&#39;Euler&#39;</span>)</span>
<span id="cb10-24"><a href="#cb10-24"></a>        plt.plot(t, yheun,color<span class="op">=</span><span class="st">&#39;navy&#39;</span>,linestyle<span class="op">=</span><span class="st">&#39;dotted&#39;</span>, label<span class="op">=</span><span class="st">&#39;Heun&#39;</span>)</span>
<span id="cb10-25"><a href="#cb10-25"></a>        plt.plot(t, yrk4,color<span class="op">=</span><span class="st">&#39;blue&#39;</span>,linestyle<span class="op">=</span><span class="st">&#39;solid&#39;</span>, label<span class="op">=</span><span class="st">&#39;RK4&#39;</span>)</span>
<span id="cb10-26"><a href="#cb10-26"></a>        plt.plot(t, yodeint,color<span class="op">=</span><span class="st">&#39;green&#39;</span>,linestyle<span class="op">=</span><span class="st">&#39;dashdot&#39;</span>, label<span class="op">=</span><span class="st">&#39;odeint&#39;</span>)</span>
<span id="cb10-27"><a href="#cb10-27"></a>        plt.plot(tcontinu, yexpo,color<span class="op">=</span><span class="st">&#39;black&#39;</span>,linestyle<span class="op">=</span><span class="st">&#39;solid&#39;</span>,linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="st">&#39;expo&#39;</span>)</span>
<span id="cb10-28"><a href="#cb10-28"></a>        plt.legend(loc <span class="op">=</span> <span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb10-29"><a href="#cb10-29"></a>        plt.title(<span class="vs">r&quot;Comparaison (avec un pas de $1/</span><span class="sc">%s</span><span class="vs">$) des methodes pour $y&#39;=y$&quot;</span><span class="op">%</span>n)</span>
<span id="cb10-30"><a href="#cb10-30"></a>        plt.savefig(os.path.join(REPERTOIRE, </span>
<span id="cb10-31"><a href="#cb10-31"></a>        <span class="st">&#39;comparaison-methodes-</span><span class="sc">%s</span><span class="st">-pas.png&#39;</span><span class="op">%</span>n), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb10-32"><a href="#cb10-32"></a>        <span class="co">#plt.show()</span></span>
<span id="cb10-33"><a href="#cb10-33"></a>        plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span>
<span id="cb10-34"><a href="#cb10-34"></a>            </span>
<span id="cb10-35"><a href="#cb10-35"></a></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co">&gt;&gt;&gt; exo3()</span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co">exp(1)=2.718281828459045</span></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="co">Pour n=4 :</span></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co">2.441406250000000   2.694855690002441   2.718209939201323   2.718281903130344</span></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="co">Erreurs absolues : </span></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="co">0.276875578459045   0.023426138456604   0.000071889257722   0.000000074671299</span></span>
<span id="cb10-43"><a href="#cb10-43"></a></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co">Pour n=10 :</span></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="co">2.593742460100000   2.714080846608224   2.718279744135166   2.718281900949100</span></span>
<span id="cb10-46"><a href="#cb10-46"></a><span class="co">Erreurs absolues : </span></span>
<span id="cb10-47"><a href="#cb10-47"></a><span class="co">0.124539368359045   0.004200981850821   0.000002084323879   0.000000072490055</span></span>
<span id="cb10-48"><a href="#cb10-48"></a></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="co">Pour n=100 :</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="co">2.704813829421526   2.718236862559957   2.718281828234404   2.718281899096809</span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="co">Erreurs absolues : </span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="co">0.013467999037519   0.000044965899088   0.000000000224641   0.000000070637764</span></span>
<span id="cb10-53"><a href="#cb10-53"></a></span>
<span id="cb10-54"><a href="#cb10-54"></a><span class="co">Pour n=1000 :</span></span>
<span id="cb10-55"><a href="#cb10-55"></a><span class="co">2.716923932235896   2.718281375751763   2.718281828459025   2.718281949830612</span></span>
<span id="cb10-56"><a href="#cb10-56"></a><span class="co">Erreurs absolues : </span></span>
<span id="cb10-57"><a href="#cb10-57"></a><span class="co">0.001357896223149   0.000000452707282   0.000000000000020   0.000000121371567</span></span>
<span id="cb10-58"><a href="#cb10-58"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div id="exercice-4-passage-à-lordre-2-résolution-de-léquation-du-pendule-non-amorti-y---siny-avec-le-schéma-deuler" class="slide section level1">
<h1>Exercice 4 Passage à l’ordre 2, résolution de l’équation du pendule non amorti <span class="math inline">\(y&#39;&#39; = - sin(y)\)</span> avec le schéma d’Euler</h1>
<p>On vectorialise en posant <span class="math inline">\(Y(t)= (y(t), y&#39;(t))\)</span> et <span class="math inline">\(F(Y(t), t)=(y&#39;(t), -sin(y(t)))\)</span></p>
<p>On a donc F de <span class="math inline">\(\mathbb{R}^2 \times \mathbb{R}\)</span> dans <span class="math inline">\(\mathbb{R}^2\)</span> telle que <span class="math inline">\(F((a,b), t) = (b, -sin(a))\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">def</span> f_pendule(z, t):</span>
<span id="cb11-4"><a href="#cb11-4"></a>    y, yp <span class="op">=</span> z  <span class="co">#y=z[0] et yp=z[1]</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="cf">return</span> np.array([yp, <span class="fl">-31.36</span><span class="op">*</span>np.sin(y)])</span>
<span id="cb11-6"><a href="#cb11-6"></a>    </span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw">def</span> exo4():</span>
<span id="cb11-9"><a href="#cb11-9"></a>    <span class="co">&quot;&quot;&quot;Fonction test de l&#39;exo 4</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">    Approximation de la solution de y&#39;&#39; = -(omega_0)^2*sin(y) sur [0;2]</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">    avec y(0)=0 et y&#39;(0)=8&quot;&quot;&quot;</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>    <span class="co">#Y est un tableau d&#39;array qui sont les approximations</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>    <span class="co">#de (y,y&#39;) aux temps tk=10k/100  (0&lt;=k&lt;=100)</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>    Y <span class="op">=</span> euler(f_pendule, <span class="dv">0</span>, np.array([<span class="dv">0</span>,<span class="dv">8</span>]), <span class="dv">2</span>, <span class="dv">100</span>)</span>
<span id="cb11-15"><a href="#cb11-15"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">101</span>)</span>
<span id="cb11-16"><a href="#cb11-16"></a>    Yarray <span class="op">=</span> np.array(Y)</span>
<span id="cb11-17"><a href="#cb11-17"></a>    plt.plot(t, Yarray[:, <span class="dv">0</span>]) <span class="co">#on extrait la première colonne de Y</span></span>
<span id="cb11-18"><a href="#cb11-18"></a>    plt.title(<span class="st">u&quot;Résolution (Euler) de  $y&#39;&#39;=-\omega_</span><span class="sc">{0}</span><span class="st">^</span><span class="sc">{2}</span><span class="st">\sin(y)$ avec </span><span class="ch">\n</span><span class="st"> $y(0)=0$ et $y&#39;(0)=8,0$ sur $[0;2]$, $100$ pas&quot;</span>)</span>
<span id="cb11-19"><a href="#cb11-19"></a>    plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo4-pendule-amorti.png&#39;</span>), dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb11-20"><a href="#cb11-20"></a>    <span class="co"># plt.show()</span></span>
<span id="cb11-21"><a href="#cb11-21"></a>    plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span>
<span id="cb11-22"><a href="#cb11-22"></a></span>
<span id="cb11-23"><a href="#cb11-23"></a></span>
<span id="cb11-24"><a href="#cb11-24"></a></span>
<span id="cb11-25"><a href="#cb11-25"></a> </span></code></pre></div>
</div>
<div id="exercice-5-comparaison-des-quatre-méthodes-pour-la-résolution-approchée-de-y-siny-avec-y00-et-y015-sur-010" class="slide section level1">
<h1>Exercice 5 Comparaison des quatre méthodes pour la résolution approchée de <span class="math inline">\(y&#39;&#39;=-\sin(y)\)</span> avec <span class="math inline">\(y(0)=0\)</span> et <span class="math inline">\(y&#39;(0)=1,5\)</span> sur <span class="math inline">\([0;10]\)</span></h1>
<p><img src="jolis-dessins/exo5-20-pas.png" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">def</span> exo5():</span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="co">&quot;&quot;&quot;Fonction test de l&#39;exo 5</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">    Solutions  de y&#39;&#39; = -(omega_0)^2*sin(y) sur [0;2]</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">    avec y(0)=0 et y&#39;(0)=8</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">    pour n dans {20,100,1000}&quot;&quot;&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="co">#Y est un tableau d&#39;array qui sont les approximations</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>    <span class="co">#de (y,y&#39;) aux temps tk=10/k  (0&lt;=k&lt;=100)</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>    methode <span class="op">=</span> [euler, heun, RK4, odeint]</span>
<span id="cb12-10"><a href="#cb12-10"></a>    <span class="co">#couleur = [&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;,  &#39;black&#39;]</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>    style <span class="op">=</span> [<span class="st">&#39;--&#39;</span>,<span class="st">&#39;-.&#39;</span>,<span class="st">&#39;-&#39;</span>,<span class="st">&#39;-&#39;</span>]</span>
<span id="cb12-12"><a href="#cb12-12"></a>    width <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb12-13"><a href="#cb12-13"></a>    etiquette <span class="op">=</span> [<span class="st">&#39;Euler&#39;</span>, <span class="st">&#39;Heun&#39;</span>, <span class="st">&#39;RK4&#39;</span>, <span class="st">&#39;odeint&#39;</span>]</span>
<span id="cb12-14"><a href="#cb12-14"></a>    <span class="cf">for</span> n <span class="kw">in</span> [<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">1000</span>]:</span>
<span id="cb12-15"><a href="#cb12-15"></a>        t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span>, n<span class="op">+</span><span class="dv">1</span>)  </span>
<span id="cb12-16"><a href="#cb12-16"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb12-17"><a href="#cb12-17"></a>            <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">3</span>:                  </span>
<span id="cb12-18"><a href="#cb12-18"></a>                Y <span class="op">=</span> methode[i](f_pendule, <span class="dv">0</span>, np.array([<span class="dv">0</span>,<span class="dv">8</span>]), <span class="dv">2</span>, n)</span>
<span id="cb12-19"><a href="#cb12-19"></a>                Yarray <span class="op">=</span> np.array(Y)</span>
<span id="cb12-20"><a href="#cb12-20"></a>                <span class="co">#on extrait la première colonne de Y</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>                plt.plot(t, Yarray[:, <span class="dv">0</span>], linestyle<span class="op">=</span>style[i],</span>
<span id="cb12-22"><a href="#cb12-22"></a>                                        linewidth<span class="op">=</span>width[i], label<span class="op">=</span>etiquette[i])</span>
<span id="cb12-23"><a href="#cb12-23"></a>            <span class="cf">else</span>:</span>
<span id="cb12-24"><a href="#cb12-24"></a>                Y <span class="op">=</span> odeint(f_pendule, np.array([<span class="dv">0</span>,<span class="dv">8</span>]), t)</span>
<span id="cb12-25"><a href="#cb12-25"></a>                Yarray <span class="op">=</span> np.array(Y)</span>
<span id="cb12-26"><a href="#cb12-26"></a>                <span class="co">#on extrait la première colonne de Y</span></span>
<span id="cb12-27"><a href="#cb12-27"></a>                plt.plot(t, Yarray[:, <span class="dv">0</span>], linestyle<span class="op">=</span>style[i],</span>
<span id="cb12-28"><a href="#cb12-28"></a>                                        linewidth<span class="op">=</span>width[i], label<span class="op">=</span>etiquette[i])</span>
<span id="cb12-29"><a href="#cb12-29"></a>        plt.title(<span class="st">u&quot;Résolution de  $y&#39;&#39;=-\omega_</span><span class="sc">{0}</span><span class="st">^</span><span class="sc">{2}</span><span class="st">\sin(y)$ </span><span class="ch">\n</span><span class="st"> avec $y(0)=0$ et $y&#39;(0)=8,0$ sur $[0;2]$, </span><span class="sc">%d</span><span class="st"> pas&quot;</span><span class="op">%</span>n)</span>
<span id="cb12-30"><a href="#cb12-30"></a>        plt.legend(loc <span class="op">=</span> <span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb12-31"><a href="#cb12-31"></a>        plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo5-</span><span class="sc">%d</span><span class="st">-pas.png&#39;</span><span class="op">%</span>n), dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb12-32"><a href="#cb12-32"></a>        plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span>
<span id="cb12-33"><a href="#cb12-33"></a>        </span></code></pre></div>
</div>
<div id="exercice-6" class="slide section level1">
<h1>Exercice 6</h1>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">def</span> exo6():</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="co">&quot;&quot;&quot;Fonction test de l&#39;exo 6</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">    Solutions  de y&#39;&#39; = -(omega_0)^2*sin(y) sur [0;6]</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">    avec y(0)=0 et y&#39;(0)=11.2</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">    La solution théorique est strictement croissante</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">    et converge vers pi</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="co">#Y est un tableau d&#39;array qui sont les approximations</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>    <span class="co">#de (y,y&#39;) aux temps tk=10/k  (0&lt;=k&lt;=100)</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>    methode <span class="op">=</span> [euler, heun, RK4, odeint]</span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="co">#couleur = [&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;,  &#39;black&#39;]</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>    style <span class="op">=</span> [<span class="st">&#39;--&#39;</span>,<span class="st">&#39;-.&#39;</span>,<span class="st">&#39;-&#39;</span>,<span class="st">&#39;-&#39;</span>]</span>
<span id="cb13-14"><a href="#cb13-14"></a>    width <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb13-15"><a href="#cb13-15"></a>    n <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>    etiquette <span class="op">=</span> [<span class="st">&#39;Euler&#39;</span>, <span class="st">&#39;Heun&#39;</span>, <span class="st">&#39;RK4&#39;</span>, <span class="st">&#39;odeint&#39;</span>]</span>
<span id="cb13-17"><a href="#cb13-17"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">1</span><span class="op">+</span>n)  </span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb13-19"><a href="#cb13-19"></a>        <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">3</span>:        </span>
<span id="cb13-20"><a href="#cb13-20"></a>            Y <span class="op">=</span> methode[i](f_pendule, <span class="dv">0</span>, np.array([<span class="dv">0</span>,<span class="fl">11.2</span>]), <span class="dv">6</span>, n)</span>
<span id="cb13-21"><a href="#cb13-21"></a>        <span class="cf">else</span>:</span>
<span id="cb13-22"><a href="#cb13-22"></a>            Y <span class="op">=</span> methode[i](f_pendule, np.array([<span class="dv">0</span>,<span class="fl">11.2</span>]), t)</span>
<span id="cb13-23"><a href="#cb13-23"></a>        Yarray <span class="op">=</span> np.array(Y) <span class="co">#conversion en array pour le slicing</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>        <span class="co">#on extrait la première colonne de Y</span></span>
<span id="cb13-25"><a href="#cb13-25"></a>        plt.plot(t, Yarray[:, <span class="dv">0</span>], linestyle<span class="op">=</span>style[i],</span>
<span id="cb13-26"><a href="#cb13-26"></a>                                linewidth<span class="op">=</span>width[i], label<span class="op">=</span>etiquette[i])</span>
<span id="cb13-27"><a href="#cb13-27"></a>    plt.legend(loc <span class="op">=</span> <span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb13-28"><a href="#cb13-28"></a>    plt.title(<span class="st">u&quot;Résolution de  $y&#39;&#39;=-\omega_</span><span class="sc">{0}</span><span class="st">^</span><span class="sc">{2}</span><span class="st">\sin(y)$ avec </span><span class="ch">\n</span><span class="st"> $y(0)=0$ et $y&#39;(0)=11.2$ sur $[0;6]$, $1000$ pas&quot;</span>)</span>
<span id="cb13-29"><a href="#cb13-29"></a>    plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo6-pendule-limite.png&#39;</span>), dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb13-30"><a href="#cb13-30"></a>    plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span></code></pre></div>
</div>
<div id="exercice-7-un-peu-de-physique-chute-libre-et-parabole-de-sécurité" class="slide section level1">
<h1>Exercice 7 Un peu de physique : Chute libre et parabole de sécurité</h1>
<ul>
<li><p>On va résoudre numériquement l’équation différentielle d’ordre <span class="math inline">\(2\)</span> : <span class="math inline">\(\frac{d^{2}}{d t^{2}} \overrightarrow{OM(t)}= g\)</span> où <span class="math inline">\(g\)</span> est l’accélération de la pesanteur.</p></li>
<li><p>On vectorialise en dimension <span class="math inline">\(4\)</span> en résolvant :</p></li>
</ul>
<p><span class="math display">\[Y&#39; = F(Y,t)  \text{ où }  Y=(x,z,x&#39;,z&#39;) \text{ et }  F(Y,t) = (x&#39;,z&#39;,x_g,z_g)\]</span></p>
<ul>
<li>Les constantes de l’accélération de la pesanteur à la surface terrestre sont environ <span class="math inline">\(x_g=0\)</span> et <span class="math inline">\(z_g=-10\)</span> et puisque le projectile est lancé avec une vitesse <span class="math inline">\(v_0\)</span> constante et avec un angle <span class="math inline">\(\alpha\)</span> variable avec l’horizontale, les composantes de la vitesse initiale sont <span class="math inline">\((v_{0} \cos(\alpha), v_{0}\sin(\alpha))\)</span>.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a></span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>g <span class="op">=</span> <span class="fl">10.</span> <span class="co">#accélération de la pesanteur</span></span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw">def</span> Flibre(V, t):</span>
<span id="cb14-6"><a href="#cb14-6"></a>    x, z, xp, zp <span class="op">=</span> V</span>
<span id="cb14-7"><a href="#cb14-7"></a>    <span class="cf">return</span> np.array([xp, zp, <span class="dv">0</span>, <span class="op">-</span>g])</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="kw">def</span> chutelibre(v0, alpha, tmax, n):</span>
<span id="cb14-10"><a href="#cb14-10"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">    parabole approchée avec odeint</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">    sur l&#39;intervalle entre 0 et tmax avec n temps</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">    et les conditions initiales vo et alpha</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, tmax, n<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb14-16"><a href="#cb14-16"></a>    yodeint <span class="op">=</span> odeint(Flibre, np.array([<span class="dv">0</span>, <span class="dv">0</span>, v0<span class="op">*</span>np.cos(alpha),</span>
<span id="cb14-17"><a href="#cb14-17"></a>                                v0<span class="op">*</span>np.sin(alpha)]), t)</span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="co">#on ne garde que les z&gt;=0</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>    <span class="co">#puis on convertit en array  pour le slicing                             </span></span>
<span id="cb14-20"><a href="#cb14-20"></a>    Yodeint <span class="op">=</span> np.array([y[:<span class="dv">2</span>] <span class="cf">for</span> y <span class="kw">in</span> yodeint <span class="cf">if</span> y[<span class="dv">1</span>] <span class="op">&gt;=</span> <span class="dv">0</span>]) </span>
<span id="cb14-21"><a href="#cb14-21"></a>    plt.plot(Yodeint[:,<span class="dv">0</span>], Yodeint[:,<span class="dv">1</span>])</span>
<span id="cb14-22"><a href="#cb14-22"></a></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="kw">def</span> exo7question3(v0, tmax, n):</span>
<span id="cb14-24"><a href="#cb14-24"></a>    angle <span class="op">=</span> np.linspace(<span class="dv">0</span>, np.pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">50</span>)</span>
<span id="cb14-25"><a href="#cb14-25"></a>    <span class="cf">for</span> alpha <span class="kw">in</span> angle:</span>
<span id="cb14-26"><a href="#cb14-26"></a>        chutelibre(v0, alpha, tmax, n)</span>
<span id="cb14-27"><a href="#cb14-27"></a>    <span class="co">#tracé de la parabole de surete</span></span>
<span id="cb14-28"><a href="#cb14-28"></a>    <span class="co">#d&#39;équation z = v0**2/(2*g)-g/(2*v0**2)*x**2</span></span>
<span id="cb14-29"><a href="#cb14-29"></a>    <span class="co">#elle coupe l&#39;axe des abscisses en v0**2/g</span></span>
<span id="cb14-30"><a href="#cb14-30"></a>    x<span class="op">=</span>np.linspace(<span class="dv">0</span>,v0<span class="op">**</span><span class="dv">2</span><span class="op">/</span>g,<span class="dv">100</span>)</span>
<span id="cb14-31"><a href="#cb14-31"></a>    plt.plot(x,v0<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>g<span class="op">-</span>g<span class="op">/</span>v0<span class="op">**</span><span class="dv">2</span><span class="op">*</span>x<span class="op">*</span>x<span class="op">/</span><span class="dv">2</span>,linewidth<span class="op">=</span><span class="dv">4</span>,color<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb14-32"><a href="#cb14-32"></a>    plt.xlabel(<span class="vs">r&#39;$x(t)$&#39;</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb14-33"><a href="#cb14-33"></a>    plt.ylabel(<span class="vs">r&#39;$z(t)$&#39;</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb14-34"><a href="#cb14-34"></a>    plt.title(<span class="st">&#39;Chutes libres&#39;</span>)</span>
<span id="cb14-35"><a href="#cb14-35"></a>    plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo7-libre-vitesse-</span><span class="sc">%i</span><span class="st">.png&#39;</span><span class="op">%</span>v0), dpi<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb14-36"><a href="#cb14-36"></a>    plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb14-38"><a href="#cb14-38"></a><span class="co">&gt;&gt;&gt; exo7question3(10, 10, 1000)</span></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div class="slide section level1">

<ul>
<li>On suppose maintenant que le projectile est soumis à des forces de frottement de la forme <span class="math inline">\(-kv\)</span></li>
<li>On va donc résoudre numériquement <span class="math inline">\(\frac{d^{2}}{d t^{2}} \overrightarrow{OM(t)}= g -k_m \times v\)</span></li>
<li>On considère :</li>
</ul>
<p><span class="math display">\[Y&#39; = F(Y,t)   \text{ où }  Y=(x,z,x&#39;,z&#39;) \text{ et } F(Y,t) = (x&#39;,z&#39;,-k_m \times x&#39;,-z_{g}-k_m \times z&#39;)\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a></span>
<span id="cb15-2"><a href="#cb15-2"></a>k_m <span class="op">=</span> <span class="dv">4</span> <span class="co">#coefficient de frottement</span></span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="kw">def</span> Famortie(V,t):</span>
<span id="cb15-5"><a href="#cb15-5"></a>    x, z, xp, zp <span class="op">=</span> V</span>
<span id="cb15-6"><a href="#cb15-6"></a>    <span class="cf">return</span> np.array([xp, zp,<span class="op">-</span>k_m<span class="op">*</span>xp,<span class="op">-</span>g<span class="op">-</span>k_m<span class="op">*</span>zp])</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="kw">def</span> chuteamortie(v0, alpha, tmax, n):</span>
<span id="cb15-9"><a href="#cb15-9"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, tmax, n<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a>    yodeint <span class="op">=</span> odeint(Famortie, np.array([<span class="dv">0</span>, <span class="dv">0</span>, v0<span class="op">*</span>np.cos(alpha),</span>
<span id="cb15-11"><a href="#cb15-11"></a>                                v0<span class="op">*</span>np.sin(alpha)]), t)</span>
<span id="cb15-12"><a href="#cb15-12"></a>    <span class="co">#on ne garde que les z&gt;=0</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>    <span class="co">#puis on convertit en array  pour le slicing                             </span></span>
<span id="cb15-14"><a href="#cb15-14"></a>    Yodeint <span class="op">=</span> np.array([y[:<span class="dv">2</span>] <span class="cf">for</span> y <span class="kw">in</span> yodeint <span class="cf">if</span> y[<span class="dv">1</span>] <span class="op">&gt;=</span> <span class="dv">0</span>]) </span>
<span id="cb15-15"><a href="#cb15-15"></a>    plt.plot(Yodeint[:,<span class="dv">0</span>], Yodeint[:,<span class="dv">1</span>])</span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="kw">def</span> exo7question5(v0, tmax, n):</span>
<span id="cb15-18"><a href="#cb15-18"></a>    angle <span class="op">=</span> np.linspace(<span class="dv">0</span>, np.pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">50</span>)</span>
<span id="cb15-19"><a href="#cb15-19"></a>    <span class="cf">for</span> alpha <span class="kw">in</span> angle:</span>
<span id="cb15-20"><a href="#cb15-20"></a>        chuteamortie(v0, alpha, tmax, n)    </span>
<span id="cb15-21"><a href="#cb15-21"></a>    plt.xlabel(<span class="vs">r&#39;$x(t)$&#39;</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb15-22"><a href="#cb15-22"></a>    plt.ylabel(<span class="vs">r&#39;$z(t)$&#39;</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb15-23"><a href="#cb15-23"></a>    plt.title(<span class="st">&#39;Chutes amorties&#39;</span>)</span>
<span id="cb15-24"><a href="#cb15-24"></a>    plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo7-amortie-vitesse-</span><span class="sc">%i</span><span class="st">.png&#39;</span><span class="op">%</span>v0), dpi<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb15-25"><a href="#cb15-25"></a>    plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span>
<span id="cb15-26"><a href="#cb15-26"></a></span>
<span id="cb15-27"><a href="#cb15-27"></a></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">&gt;&gt;&gt; exo7question5(10, 10, 1000)</span></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div id="exercice-8-cinétique-chimique" class="slide section level1">
<h1>Exercice 8 Cinétique chimique</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">def</span> Ford(Y,t,ordre,alpha,beta):</span>
<span id="cb16-3"><a href="#cb16-3"></a>    A, B, C <span class="op">=</span> Y</span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="cf">return</span> np.array([<span class="op">-</span>alpha<span class="op">*</span>A<span class="op">**</span>ordre, alpha<span class="op">*</span>A<span class="op">**</span>ordre <span class="op">-</span> beta<span class="op">*</span>B<span class="op">**</span>ordre,</span>
<span id="cb16-5"><a href="#cb16-5"></a>     beta<span class="op">*</span>B<span class="op">**</span>ordre])</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="kw">def</span> exo8(F, ordre):</span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="cf">for</span> alpha, beta <span class="kw">in</span> [(<span class="dv">1</span>, <span class="dv">1</span>), (<span class="dv">10</span>, <span class="dv">1</span>), (<span class="dv">1</span>, <span class="dv">10</span>)]:</span>
<span id="cb16-9"><a href="#cb16-9"></a>        Fbis <span class="op">=</span> <span class="kw">lambda</span> Y, t : F(Y, t, ordre, alpha, beta)</span>
<span id="cb16-10"><a href="#cb16-10"></a>        t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">1000</span>)</span>
<span id="cb16-11"><a href="#cb16-11"></a>        yodeint <span class="op">=</span> odeint(Fbis, np.array([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]), t)</span>
<span id="cb16-12"><a href="#cb16-12"></a>        Yodeint <span class="op">=</span> np.array(yodeint)</span>
<span id="cb16-13"><a href="#cb16-13"></a>        plt.plot(t, Yodeint[:,<span class="dv">0</span>], linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>) <span class="co">#tracé de la concentration de A</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>        plt.plot(t, Yodeint[:,<span class="dv">1</span>],linestyle<span class="op">=</span><span class="st">&#39;-.&#39;</span>) <span class="co">#tracé de la concentration de B</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>        plt.plot(t, Yodeint[:,<span class="dv">2</span>]) <span class="co">#tracé de la concentration de C</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>        plt.title(<span class="vs">r&#39;Concentrations chimiques $\alpha$=</span><span class="sc">%d</span><span class="vs">, $\beta$=</span><span class="sc">%d</span><span class="vs">&#39;</span><span class="op">%</span>(alpha,beta))</span>
<span id="cb16-17"><a href="#cb16-17"></a>        plt.legend([<span class="st">&#39;[A]&#39;</span>, <span class="st">&#39;[B]&#39;</span>, <span class="st">&#39;[C]&#39;</span>], loc <span class="op">=</span> <span class="st">&#39;center right&#39;</span>)</span>
<span id="cb16-18"><a href="#cb16-18"></a>        plt.grid(<span class="va">True</span>)</span>
<span id="cb16-19"><a href="#cb16-19"></a>        plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo8-ordre</span><span class="sc">%d</span><span class="st">-alpha</span><span class="sc">%d</span><span class="st">-beta</span><span class="sc">%d</span><span class="st">.png&#39;</span><span class="op">%</span>(ordre,alpha,beta)))</span>
<span id="cb16-20"><a href="#cb16-20"></a>        plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span>
<span id="cb16-21"><a href="#cb16-21"></a> </span></code></pre></div>
</div>
<div id="exercice-9-instabilité-des-schémas-numériques" class="slide section level1">
<h1>Exercice 9 Instabilité des schémas numériques</h1>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
<ul>
<li>La solution générale de <span class="math inline">\(y&#39;&#39; = -2y&#39;+3y\)</span> est de la forme <span class="math inline">\(y{\left (x \right )} = C_{1} e^{- 3 x} + C_{2} e^{x}\)</span>. On peut le vérifier avec la fonction <code>sympy.dsolve</code> du module de calcul formel <code>sympy</code></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">In [18]: import sympy</span></span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">In [19]: from sympy.abc import f, x</span></span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">In [20]: diffeq = sympy.Eq(f(x).diff(x,x) + 2*f(x).diff(x) - 3*f(x),0)</span></span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">In [21]: diffeq</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">Out[21]: -3*f(x) + 2*Derivative(f(x), x) + Derivative(f(x), x, x) == 0</span></span>
<span id="cb18-11"><a href="#cb18-11"></a></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">In [22]: sympy.dsolve(diffeq, f(x))</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">Out[22]: f(x) == C1*exp(-3*x) + C2*exp(x)</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
<ul>
<li><p>La solution particulière pour les conditions initiales <span class="math inline">\(y(0)=1\)</span> et <span class="math inline">\(y&#39;(0)=-3\)</span> est <span class="math inline">\(y(x) = e^{-3x}\)</span></p></li>
<li><p>Elle vérifie pour tout réel <span class="math inline">\(x\)</span>, <span class="math inline">\(y&#39;(x) = -3 \times e^{-3x}\)</span> et donc <span class="math inline">\(y&#39;(x)+3y(x)=0\)</span>.</p>
<p>C’est vrai pour <span class="math inline">\(x=0\)</span>.</p>
<p>Dès les premières étapes du schéma, avec les petites approximations, cette égalité n’est plus vérifiée (les réels sont représentés de façon approchée par des flottants).</p>
<p>A chaque étape on résout alors numériquement des équations différentielles vérifiant des conditions initiales légèrement différentes.</p>
<p>Leurs solutions vont comporter un terme en <span class="math inline">\(e^{x}\)</span> qui va diverger quand <span class="math inline">\(x\)</span> va tendre vers <span class="math inline">\(+\infty\)</span>.</p></li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">def</span> instable1(Y, t):</span>
<span id="cb19-2"><a href="#cb19-2"></a>    y, yp <span class="op">=</span> Y</span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="cf">return</span> np.array([yp, <span class="dv">-2</span><span class="op">*</span>yp <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>y])</span>
<span id="cb19-4"><a href="#cb19-4"></a>    </span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="kw">def</span> exo9(F, y0, yp0):</span>
<span id="cb19-9"><a href="#cb19-9"></a>    methode <span class="op">=</span> [euler, heun, RK4, odeint]</span>
<span id="cb19-10"><a href="#cb19-10"></a>    <span class="cf">if</span> F.<span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;instable1&quot;</span>:</span>
<span id="cb19-11"><a href="#cb19-11"></a>        tmax <span class="op">=</span> [<span class="dv">37</span>, <span class="dv">36</span>, <span class="dv">35</span>, <span class="dv">80</span>] <span class="co">#tmax varie selon le schéma</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="cf">else</span>:</span>
<span id="cb19-13"><a href="#cb19-13"></a>        tmax <span class="op">=</span> [<span class="dv">37</span>, <span class="dv">36</span>, <span class="dv">35</span>, <span class="dv">26</span>]</span>
<span id="cb19-14"><a href="#cb19-14"></a>    style <span class="op">=</span> [<span class="st">&#39;--&#39;</span>,<span class="st">&#39;-.&#39;</span>,<span class="st">&#39;-&#39;</span>,<span class="st">&#39;-&#39;</span>]</span>
<span id="cb19-15"><a href="#cb19-15"></a>    width <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb19-16"><a href="#cb19-16"></a>    n <span class="op">=</span> <span class="dv">1000</span>  </span>
<span id="cb19-17"><a href="#cb19-17"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb19-18"><a href="#cb19-18"></a>        t <span class="op">=</span> np.linspace(<span class="dv">0</span>, tmax[i], <span class="dv">1</span><span class="op">+</span>n)</span>
<span id="cb19-19"><a href="#cb19-19"></a>        <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">3</span>:                  </span>
<span id="cb19-20"><a href="#cb19-20"></a>            Y <span class="op">=</span> methode[i](F, <span class="dv">0</span>, np.array([y0, yp0]), tmax[i], n)</span>
<span id="cb19-21"><a href="#cb19-21"></a>        <span class="cf">else</span>:</span>
<span id="cb19-22"><a href="#cb19-22"></a>            Y <span class="op">=</span> methode[i](F, np.array([y0, yp0]), t)</span>
<span id="cb19-23"><a href="#cb19-23"></a>        Yarray <span class="op">=</span> np.array(Y) <span class="co">#conversion en array pour le slicing</span></span>
<span id="cb19-24"><a href="#cb19-24"></a>        <span class="co">#on extrait la première colonne de Y</span></span>
<span id="cb19-25"><a href="#cb19-25"></a>        plt.plot(t, Yarray[:, <span class="dv">0</span>], linestyle<span class="op">=</span>style[i],linewidth<span class="op">=</span>width[i])</span>
<span id="cb19-26"><a href="#cb19-26"></a>    plt.legend([<span class="st">&#39;Euler&#39;</span>, <span class="st">&#39;Heun&#39;</span>, <span class="st">&#39;RK4&#39;</span>, <span class="st">&#39;odeint&#39;</span>], loc <span class="op">=</span> <span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb19-27"><a href="#cb19-27"></a>    plt.title(<span class="st">&#39;Une situation instable&#39;</span>)</span>
<span id="cb19-28"><a href="#cb19-28"></a>    plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo9-</span><span class="sc">%s</span><span class="st">.png&#39;</span><span class="op">%</span>F.<span class="va">__name__</span>), dpi<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb19-29"><a href="#cb19-29"></a>    plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span>
<span id="cb19-30"><a href="#cb19-30"></a></span>
<span id="cb19-31"><a href="#cb19-31"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb19-32"><a href="#cb19-32"></a><span class="co">&gt;&gt;&gt; exo9(instable1,1,-3)</span></span>
<span id="cb19-33"><a href="#cb19-33"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div class="slide section level1">

<ul>
<li><p>On résout l’équation translatée <span class="math inline">\(y&#39;&#39; = -2y&#39;+3y - 1\)</span> en prenant comme conditions initiales <span class="math inline">\(y(0)=\frac{4}{3}\)</span> et <span class="math inline">\(y&#39;(0)=-3\)</span></p></li>
<li><p>La solution générale de cette équation est <span class="math inline">\(y{\left (x \right )} = C_{1} e^{- 3 x} + C_{2} e^{x} + \frac{1}{3}\)</span>.</p></li>
<li><p>La solution particulière est <span class="math inline">\(y(x)= e^{- 3 x}\)</span>.</p></li>
<li><p>On observe encore une instabilité des schémas numériques de résolution.</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">def</span> instable2(Y, t):</span>
<span id="cb20-3"><a href="#cb20-3"></a>    y, yp <span class="op">=</span> Y</span>
<span id="cb20-4"><a href="#cb20-4"></a>    <span class="cf">return</span> np.array([yp, <span class="dv">-2</span><span class="op">*</span>yp <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>y <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb20-5"><a href="#cb20-5"></a>    </span>
<span id="cb20-6"><a href="#cb20-6"></a>    </span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">&gt;&gt;&gt; exo9(instable2,4/3.,-3) </span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div id="exercice-10-équation-de-vanderpol-x-mu-times-1-x2-times-x---x" class="slide section level1">
<h1>Exercice 10 Équation de Vanderpol <span class="math inline">\(x&#39;&#39; = \mu \times (1-x^2) \times x&#39; - x\)</span></h1>
<p>Portrait de phase <span class="math inline">\((x, x&#39;)\)</span> pour la résolution numérique avec <code>odeint</code> de l’équation de Vanderpol <span class="math inline">\(x&#39;&#39; = \mu \times (1-x^2) \times x&#39; - x\)</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a></span>
<span id="cb21-2"><a href="#cb21-2"></a>mu <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="kw">def</span> vanderpol(X,t):</span>
<span id="cb21-5"><a href="#cb21-5"></a>    x, xp <span class="op">=</span> X</span>
<span id="cb21-6"><a href="#cb21-6"></a>    <span class="cf">return</span> np.array([xp, xp<span class="op">*</span>mu<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>)<span class="op">-</span>x])</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="kw">def</span> exo10():</span>
<span id="cb21-9"><a href="#cb21-9"></a>    style <span class="op">=</span> [<span class="st">&#39;--&#39;</span>,<span class="st">&#39;-.&#39;</span>,<span class="st">&#39;-&#39;</span>]</span>
<span id="cb21-10"><a href="#cb21-10"></a>    width <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb21-11"><a href="#cb21-11"></a>    cinit <span class="op">=</span> [[<span class="dv">0</span>, <span class="dv">3</span>], [<span class="fl">0.1</span>, <span class="dv">0</span>], [<span class="dv">3</span>, <span class="dv">0</span>]]</span>
<span id="cb21-12"><a href="#cb21-12"></a>    tmax <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>    n <span class="op">=</span> <span class="dv">1000</span>  </span>
<span id="cb21-14"><a href="#cb21-14"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb21-15"><a href="#cb21-15"></a>        t <span class="op">=</span> np.linspace(<span class="dv">0</span>, tmax, <span class="dv">1</span><span class="op">+</span>n)</span>
<span id="cb21-16"><a href="#cb21-16"></a>        Y <span class="op">=</span> odeint(vanderpol, cinit[i], t)</span>
<span id="cb21-17"><a href="#cb21-17"></a>        Yarray <span class="op">=</span> np.array(Y) <span class="co">#conversion en array pour le slicing</span></span>
<span id="cb21-18"><a href="#cb21-18"></a>        <span class="co">#on extrait la première colonne de Y</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>        plt.plot(Yarray[:, <span class="dv">0</span>], Yarray[:, <span class="dv">1</span>], linestyle<span class="op">=</span>style[i],</span>
<span id="cb21-20"><a href="#cb21-20"></a>                                            linewidth<span class="op">=</span>width[i])</span>
<span id="cb21-21"><a href="#cb21-21"></a>    plt.axhline(color<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb21-22"><a href="#cb21-22"></a>    plt.axvline(color<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb21-23"><a href="#cb21-23"></a>    plt.xlabel(<span class="vs">r&#39;$x(t)$&#39;</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb21-24"><a href="#cb21-24"></a>    plt.ylabel(<span class="vs">r&quot;$x&#39;(t)$&quot;</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb21-25"><a href="#cb21-25"></a>    plt.grid()</span>
<span id="cb21-26"><a href="#cb21-26"></a>    plt.legend([<span class="vs">r&quot;$(x(0),x&#39;(0))=(0,3)$&quot;</span>, <span class="vs">r&quot;$(x(0),x&#39;(0))=(1/10,0)$&quot;</span>,</span>
<span id="cb21-27"><a href="#cb21-27"></a>                <span class="vs">r&quot;$(x(0),x&#39;(0))=(3,0)$&quot;</span>], loc <span class="op">=</span> <span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb21-28"><a href="#cb21-28"></a>    plt.savefig(os.path.join(REPERTOIRE,<span class="st">&#39;exo10.png&#39;</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb21-29"><a href="#cb21-29"></a>    plt.clf() <span class="co"># faire de la place pour une nouvelle figure</span></span></code></pre></div>
</div>
</body>
</html>
